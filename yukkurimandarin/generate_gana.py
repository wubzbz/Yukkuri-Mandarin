# 基于全局规则生成假名音声。
# 仅用于快速批量生成。


def generate_hiragana(yinjie: str, tone: str, without_accent: bool = False) -> str:
    """
    获取单字拼音对应的假名音声。

    Args:
        yinjie: 音节（不含声调的拼音）
        tone: 前一字、本字、后一字的声调
        without_accent: 不含音声记号

    Returns:
        含有音声记号的平假名
    """
    # 类型检查
    if not isinstance(yinjie, str):
        raise ValueError("参数类型错误！必须是字符串。")
    # 匹配假名
    gana = YINJIE.get(yinjie)
    if not gana:
        return ""
    if without_accent:
        return f"{gana[0]}{gana[1]}"
    # 提取声调
    if not(len(tone) == 3 and isinstance(tone, str)):
        raise ValueError(f"声调必须是3位数字组成的字符串: {tone}.") 
    last_tone = tone[0]
    this_tone = tone[1]
    next_tone = tone[2]
    if (last_tone not in "012345") or (this_tone not in "12345") or (next_tone not in "012345"):
        raise ValueError(f"声调格式错误: {tone}.")
    # 匹配音声记号    
    if this_tone in "15":
        if last_tone == "0":
            return f"/っ{gana[0]}{gana[1]}"
        else:
            return f"{gana[0]}{gana[1]}"
    elif this_tone == "2":
        return f"/{gana[0]}{gana[1]}"
    elif this_tone == "3":
        if last_tone == "4":
            if next_tone in "03":
                return f"{gana[0]}{gana[1]}"
            else:
                return f"{gana[0]}/{gana[1]}"
        else:
            if next_tone == "3":
                return f"\'{gana[0]}{gana[1]}"
            else:
                return f"\'{gana[0]}/{gana[1]}"
    else:
        if next_tone in "023":
            return f"{gana[0]}\'{gana[1]}"
        elif last_tone == "0":
            return f"{gana[0]}\'/{gana[1]}"
        else:
            return f"{gana[0]}/{gana[1]}"


# 汉语音节——平假名对应关系
YINJIE = {
    "a": ["あ", "あ"],
    "ai": ["あ", "い"],
    "an": ["あ", "ん"],
    "ang": ["あ", "ん"],
    "ao": ["あ", "お"],
    "ba": ["ば", "あ"],
    "bai": ["ば", "い"],
    "ban": ["ば", "ん"],
    "bang": ["ば", "あん"],
    "bao": ["ば", "お"],
    "bei": ["べ", "い"],
    "ben": ["べ", "ん"],
    "beng": ["べ", "えん"],
    "bi": ["び", "い"],
    "bian": ["びゃ", "ん"],
    "biao": ["びゃ", "お"],
    "bie": ["び", "え"],
    "bin": ["び", "ん"],
    "bing": ["び", "いん"],
    "bo": ["ぼ", "お"],
    "bu": ["ぶ", "う"],
    "ca": ["つ", "あ"],
    "cai": ["つぁ", "い"],
    "can": ["つぁ", "ん"],
    "cang": ["つあ", "ん"],
    "cao": ["つぁ", "お"],
    "ce": ["つ", "え"],
    "cen": ["つぇ", "ん"],
    "ceng": ["つえ", "ん"],
    "cha": ["つ", "あ"],
    "chai": ["つぁ", "い"],
    "chan": ["つぁ", "ん"],
    "chang": ["つあ", "ん"],
    "chao": ["つあ", "お"],
    "che": ["つ", "え"],
    "chen": ["ちぇ", "ん"],
    "cheng": ["ち", "えん"],
    "chi": ["つ", "い"],
    "chong": ["つ", "おん"],
    "chou": ["つぉ", "う"],
    "chu": ["つ", "う"],
    "chua": ["つ", "わ"],
    "chuai": ["つ", "わい"],
    "chuan": ["つ", "わん"],
    "chuang": ["つ", "わん"],
    "chui": ["つ", "うい"],
    "chun": ["つ", "うん"],
    "chuo": ["つ", "うお"],
    "ci": ["つ", "い"],
    "cong": ["つぉ", "ん"],
    "cou": ["つぉ", "う"],
    "cu": ["つ", "う"],
    "cuan": ["つ", "わん"],
    "cui": ["つ", "うい"],
    "cun": ["つ", "うん"],
    "cuo": ["つ", "を"],
    "da": ["だ", "あ"],
    "dai": ["だ", "い"],
    "dan": ["だ", "ん"],
    "dang": ["だ", "あん"],
    "dao": ["だ", "お"],
    "de": ["で", "え"],
    "dei": ["で", "い"],
    "den": ["で", "ん"],
    "deng": ["で", "えん"],
    "di": ["でぃ", "い"],
    "dia": ["でぃ", "あ"],
    "dian": ["でぃ", "あん"],
    "diao": ["でぃ", "あお"],
    "die": ["でぃ", "え"],
    "ding": ["でぃ", "ん"],
    "diu": ["でぃ", "う"],
    "dong": ["ど", "ん"],
    "dou": ["ど", "う"],
    "du": ["で", "う"],
    "duan": ["でわ", "ん"],
    "dui": ["で", "うい"],
    "dun": ["で", "うん"],
    "duo": ["で", "うお"],
    "e": ["え", "え"],
    "ei": ["え", "い"],
    "en": ["え", "ん"],
    "eng": ["え", "ん"],
    "er": ["え", "え"],
    "fa": ["ふぁ", "あ"],
    "fan": ["ふぁ", "ん"],
    "fang": ["ふぁ", "あん"],
    "fei": ["ふぇ", "い"],
    "fen": ["ふぇ", "ん"],
    "feng": ["ふぇ", "えん"],
    "fo": ["ふぉ", "お"],
    "fou": ["ふぉ", "う"],
    "fu": ["ふ", "う"],
    "ga": ["が", "あ"],
    "gai": ["が", "い"],
    "gan": ["が", "ん"],
    "gang": ["が", "あん"],
    "gao": ["が", "お"],
    "ge": ["げ", "え"],
    "gei": ["げ", "い"],
    "gen": ["げ", "ん"],
    "geng": ["げ", "ん"],
    "gong": ["ご", "ん"],
    "gou": ["ご", "う"],
    "gu": ["ぐ", "う"],
    "gua": ["ぐ", "あ"],
    "guai": ["ぐあ", "い"],
    "guan": ["ぐあ", "ん"],
    "guang": ["ぐ", "あん"],
    "gui": ["ぐ", "い"],
    "gun": ["ぐ", "ん"],
    "guo": ["ぐ", "お"],
    "ha": ["は", "あ"],
    "hai": ["は", "い"],
    "han": ["は", "ん"],
    "hang": ["は", "あん"],
    "hao": ["は", "お"],
    "he": ["へ", "え"],
    "hei": ["へ", "い"],
    "hen": ["へ", "ん"],
    "heng": ["へ", "えん"],
    "hm": ["ふ", "ん"],
    "hng": ["ふ", "ん"],
    "hong": ["ほ", "ん"],
    "hou": ["ほ", "う"],
    "hu": ["ふ", "う"],
    "hua": ["ふ", "あ"],
    "huai": ["ふ", "あい"],
    "huan": ["ふ", "あん"],
    "huang": ["ふ", "あん"],
    "hui": ["ふ", "い"],
    "hun": ["ふう", "ん"],
    "huo": ["ふ", "お"],
    "ji": ["じ", "い"],
    "jia": ["じゃ", "あ"],
    "jian": ["じゃ", "ん"],
    "jiang": ["じゃ", "あん"],
    "jiao": ["じゃ", "お"],
    "jie": ["じ", "え"],
    "jin": ["じ", "ん"],
    "jing": ["じ", "いん"],
    "jiong": ["じょ", "ん"],
    "jiu": ["じゅ", "う"],
    "ju": ["じ", "う"],
    "juan": ["じゅ", "あん"],
    "jue": ["じゅ", "え"],
    "jun": ["じゅ", "ん"],
    "ka": ["か", "あ"],
    "kai": ["か", "い"],
    "kan": ["か", "ん"],
    "kang": ["か", "あん"],
    "kao": ["か", "お"],
    "ke": ["け", "え"],
    "kei": ["け", "い"],
    "ken": ["け", "ん"],
    "keng": ["け", "えん"],
    "kong": ["こ", "ん"],
    "kou": ["こ", "う"],
    "ku": ["く", "う"],
    "kua": ["く", "あ"],
    "kuai": ["く", "あい"],
    "kuan": ["く", "あん"],
    "kuang": ["く", "あん"],
    "kui": ["く", "い"],
    "kun": ["く", "ん"],
    "kuo": ["く", "お"],
    "la": ["ら", "あ"],
    "lai": ["ら", "い"],
    "lan": ["ら", "ん"],
    "lang": ["ら", "あん"],
    "lao": ["ら", "お"],
    "le": ["れ", "え"],
    "lei": ["れ", "い"],
    "leng": ["れ", "ん"],
    "li": ["り", "い"],
    "lia": ["り", "あ"],
    "lian": ["りゃ", "ん"],
    "liang": ["りあ", "ん"],
    "liao": ["り", "あお"],
    "lie": ["り", "え"],
    "lin": ["り", "ん"],
    "ling": ["り", "いん"],
    "liu": ["り", "う"],
    "lo": ["ろ", "お"],
    "long": ["ろ", "ん"],
    "lou": ["ろ", "う"],
    "lu": ["る", "う"],
    "lv": ["り", "う"],
    "luan": ["る", "あん"],
    "lve": ["る", "え"],
    "lun": ["る", "ん"],
    "luo": ["る", "お"],
    "m": ["ん", "ん"],
    "ma": ["ま", "あ"],
    "mai": ["ま", "い"],
    "man": ["ま", "ん"],
    "mang": ["ま", "あん"],
    "mao": ["ま", "お"],
    "me": ["め", "え"],
    "mei": ["め", "い"],
    "men": ["め", "ん"],
    "meng": ["め", "えん"],
    "mi": ["み", "い"],
    "mian": ["みゃ", "ん"],
    "miao": ["みゃ", "お"],
    "mie": ["み", "え"],
    "min": ["み", "ん"],
    "ming": ["み", "いん"],
    "miu": ["み", "う"],
    "mo": ["も", "お"],
    "mou": ["も", "う"],
    "mu": ["む", "う"],
    "n": ["ん", "ん"],
    "na": ["な", "あ"],
    "nai": ["な", "い"],
    "nan": ["な", "ん"],
    "nang": ["な", "あん"],
    "nao": ["な", "お"],
    "ne": ["ね", "え"],
    "nei": ["ね", "い"],
    "nen": ["ね", "ん"],
    "neng": ["ね", "えん"],
    "ng": ["ん", "ん"],
    "ni": ["に", "い"],
    "nian": ["にゃ", "ん"],
    "niang": ["にゃ", "あん"],
    "niao": ["にゃ", "お"],
    "nie": ["に", "え"],
    "nin": ["に", "ん"],
    "ning": ["に", "いん"],
    "niu": ["にゅ", "う"],
    "nong": ["の", "ん"],
    "nou": ["の", "う"],
    "nu": ["ぬ", "う"],
    "nv": ["ぬ", "い"],
    "nuan": ["ぬ", "あん"],
    "nve": ["ぬ", "え"],
    "nuo": ["ぬ", "お"],
    "o": ["お", "お"],
    "ou": ["お", "う"],
    "pa": ["ぱ", "あ"],
    "pai": ["ぱ", "い"],
    "pan": ["ぱ", "ん"],
    "pang": ["ぱ", "あん"],
    "pao": ["ぱ", "お"],
    "pei": ["ぺ", "い"],
    "pen": ["ぺ", "ん"],
    "peng": ["ぺ", "えん"],
    "pi": ["ぴ", "い"],
    "pian": ["ぴゃ", "ん"],
    "piao": ["ぴゃ", "お"],
    "pie": ["ぴ", "え"],
    "pin": ["ぴ", "ん"],
    "ping": ["ぴ", "いん"],
    "po": ["ぽ", "お"],
    "pou": ["ぽ", "う"],
    "pu": ["ぷ", "う"],
    "qi": ["ち", "い"],
    "qia": ["ちゃ", "あ"],
    "qian": ["ちゃ", "ん"],
    "qiang": ["ちゃ", "あん"],
    "qiao": ["ちゃ", "お"],
    "qie": ["ち", "え"],
    "qin": ["ち", "ん"],
    "qing": ["ち", "いん"],
    "qiong": ["ちょ", "ん"],
    "qiu": ["ちゅ", "う"],
    "qu": ["ち", "う"],
    "quan": ["ち", "わん"],
    "que": ["ち", "うえ"],
    "qun": ["ち", "うん"],
    "ran": ["ら", "ん"],
    "rang": ["ら", "あん"],
    "rao": ["ら", "お"],
    "re": ["れ", "え"],
    "ren": ["れ", "ん"],
    "reng": ["れ", "えん"],
    "ri": ["り", "い"],
    "rong": ["ろ", "ん"],
    "rou": ["ろ", "う"],
    "ru": ["る", "う"],
    "rua": ["る", "あ"],
    "ruan": ["る", "あん"],
    "rui": ["る", "い"],
    "run": ["る", "ん"],
    "ruo": ["る", "お"],
    "sa": ["さ", "あ"],
    "sai": ["さ", "い"],
    "san": ["さ", "ん"],
    "sang": ["さ", "あん"],
    "sao": ["さ", "お"],
    "se": ["せ", "え"],
    "sen": ["せ", "ん"],
    "seng": ["せ", "えん"],
    "sha": ["し", "あ"],
    "shai": ["し", "あい"],
    "shan": ["さ", "ん"],
    "shang": ["さ", "あん"],
    "shao": ["さ", "お"],
    "she": ["し", "え"],
    "shei": ["しぇ", "い"],
    "shen": ["せ", "ん"],
    "sheng": ["せ", "えん"],
    "shi": ["す", "い"],
    "shou": ["し", "おう"],
    "shu": ["す", "う"],
    "shua": ["す", "わ"],
    "shuai": ["す", "わい"],
    "shuan": ["す", "わん"],
    "shuang": ["す", "わん"],
    "shui": ["す", "うい"],
    "shun": ["す", "うん"],
    "shuo": ["す", "うお"],
    "si": ["す", "い"],
    "song": ["そ", "ん"],
    "sou": ["そ", "う"],
    "su": ["す", "う"],
    "suan": ["す", "わん"],
    "sui": ["す", "うい"],
    "sun": ["す", "ん"],
    "suo": ["す", "うお"],
    "ta": ["た", "あ"],
    "tai": ["た", "い"],
    "tan": ["た", "ん"],
    "tang": ["た", "あん"],
    "tao": ["た", "お"],
    "te": ["て", "え"],
    "teng": ["て", "ん"],
    "ti": ["てぃ", "い"],
    "tian": ["てや", "ん"],
    "tiao": ["てや", "お"],
    "tie": ["てぃ", "え"],
    "ting": ["てぃ", "ん"],
    "tong": ["と", "ん"],
    "tou": ["と", "う"],
    "tu": ["て", "う"],
    "tuan": ["て", "わん"],
    "tui": ["て", "うい"],
    "tun": ["て", "うん"],
    "tuo": ["て", "うお"],
    "wa": ["う", "あ"],
    "wai": ["わ", "い"],
    "wan": ["わ", "ん"],
    "wang": ["う", "あん"],
    "wei": ["うぇ", "い"],
    "wen": ["うぇ", "ん"],
    "weng": ["う", "えん"],
    "wo": ["う", "お"],
    "wu": ["う", "う"],
    "xi": ["し", "い"],
    "xia": ["しゃ", "あ"],
    "xian": ["しゃ", "ん"],
    "xiang": ["しゃ", "あん"],
    "xiao": ["しゃ", "お"],
    "xie": ["し", "え"],
    "xin": ["し", "ん"],
    "xing": ["し", "いん"],
    "xiong": ["しょ", "ん"],
    "xiu": ["しゅ", "う"],
    "xu": ["し", "う"],
    "xuan": ["しゅ", "あん"],
    "xue": ["しゅ", "え"],
    "xun": ["し", "うん"],
    "ya": ["や", "あ"],
    "yan": ["や", "ん"],
    "yang": ["や", "あん"],
    "yao": ["や", "お"],
    "ye": ["い", "え"],
    "yi": ["い", "い"],
    "yin": ["い", "ん"],
    "ying": ["い", "いん"],
    "yo": ["よ", "お"],
    "yong": ["よ", "ん"],
    "you": ["よ", "う"],
    "yu": ["ゆ", "う"],
    "yuan": ["ゆ", "あん"],
    "yue": ["ゆ", "え"],
    "yun": ["ゆ", "ん"],
    "za": ["ざ", "あ"],
    "zai": ["ざ", "い"],
    "zan": ["ざ", "ん"],
    "zang": ["ざ", "あん"],
    "zao": ["ざ", "お"],
    "ze": ["ぜ", "え"],
    "zei": ["ぜ", "い"],
    "zen": ["ぜ", "ん"],
    "zeng": ["ぜ", "えん"],
    "zha": ["ざ", "あ"],
    "zhai": ["ざ", "い"],
    "zhan": ["ざ", "ん"],
    "zhang": ["ざ", "あん"],
    "zhao": ["ざ", "お"],
    "zhe": ["ぜ", "え"],
    "zhei": ["ぜ", "い"],
    "zhen": ["ぜ", "ん"],
    "zheng": ["ぜ", "えん"],
    "zhi": ["ず", "い"],
    "zhong": ["ぞ", "ん"],
    "zhou": ["ぞ", "う"],
    "zhu": ["ず", "う"],
    "zhua": ["ず", "わ"],
    "zhuai": ["ず", "わい"],
    "zhuan": ["ず", "わん"],
    "zhuang": ["ず", "わん"],
    "zhui": ["ず", "うい"],
    "zhun": ["ず", "うん"],
    "zhuo": ["ず", "うお"],
    "zi": ["ず", "い"],
    "zong": ["ぞ", "ん"],
    "zou": ["ぞ", "う"],
    "zu": ["ず", "う"],
    "zuan": ["ず", "わん"],
    "zui": ["ず", "うい"],
    "zun": ["ず", "うん"],
    "zuo": ["ず", "を"],
}